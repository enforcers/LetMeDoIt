<% content_for :javascript do %>
  <script type="text/javascript">
    $(document).ready(function(){
      $('#myprofile-tabs a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
      });
      $('input').tooltip({placement: 'right'});
    });
  </script>
<% end %>

<ul class="nav nav-tabs" id="myprofile-tabs">
  <li class="active"><a href="#edit-profile">Edit Profile</a></li>
  <li><a href="#skills">My Skills</a></li>
  <li><a href="#preferences">Preferences</a></li>
</ul>
<div class="tab-content">
  <div class="tab-pane fade in active" id="edit-profile">
    <%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put, :class => "form-horizontal", :multipart => true }) do |f| %>
      <% if resource.errors.any? %>
        <div class="box error">
          <%= devise_error_messages! %>
        </div>
      <% end %>

      <div class="control-group">
        <%= f.label :email, :class => "control-label" %>
        <div class="controls">
          <%= f.email_field :email %>
        </div>
      </div>

      <div class="control-group">
        <%= f.label :username, :class => "control-label" %>
        <div class="controls">
          <%= f.text_field :username %>
        </div>
      </div>

      <div class="control-group">
        <%= f.label :aboutMe, :class => "control-label" %>
        <div class="controls">
          <%= f.text_area :aboutMe %>
        </div>
        <%= f.label :photo, :class => "control-label" %>
        <% if resource.photo.nil? %>
          <div class="controls">
            <div class="fileupload fileupload-new" data-provides="fileupload">
              <div class="fileupload-new thumbnail" style="width: 50px; height: 50px;"><img src="http://placehold.it/50x50/EFEFEF/AAAAAA" /></div>
              <div class="fileupload-preview fileupload-exists thumbnail" style="width: 50px; height: 50px;"></div>
              <span class="btn btn-file"><span class="fileupload-new">Select image</span><span class="fileupload-exists">Change</span><%= f.file_field :photo %></span>
              <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
            </div>
          </div>
        <% else %>
          <div class="controls">
              <div class="fileupload fileupload-exists" data-provides="fileupload">
                <div class="fileupload-new thumbnail" style="width: 50px; height: 50px;"><img src="http://placehold.it/50x50/EFEFEF/AAAAAA" /></div>
                <div class="fileupload-preview fileupload-exists thumbnail" style="width: 50px; height: 50px; line-height: 50px"><%= image_tag resource.photo.url(:small) %></div>
                <span class="btn btn-file"><span class="fileupload-new">Select image</span><span class="fileupload-exists">Change</span><%= f.file_field :photo %></span>
                <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
              </div>
            </div>
        <% end %>
      </div>

      <div class="control-group">
        <%= f.label :password, "Password", :class => "control-label" %>
        <div class="controls">
          <%= f.password_field :password, :autocomplete => "off", :title => "Leave blank if you don't want to change it" %>
        </div>
      </div>

      <div class="control-group">
        <%= f.label :password_confirmation, :class => "control-label" %>
        <div class="controls">
          <%= f.password_field :password_confirmation %>
        </div>
      </div>

      <div class="control-group">
        <%= f.label :current_password, "Current Password", :class => "control-label" %>
        <div class="controls">
          <%= f.password_field :current_password, :title => "We need your current password to confirm your changes" %>
        </div>
      </div>

      <div class="form-actions">
        <%= f.submit "Update", :class => "btn btn-primary btn-large" %>
      </div>
    <% end %>
  </div>
  <div class="tab-pane fade" id="skills">
    <p>
      <%= link_to "New Skill", new_skill_path, :class => "ym-button ym-add" %>
      <%= render :partial => 'skills/index', :locals =>{ :withActions => true } %>
    </p>
  </div>
  <div class="tab-pane fade" id="preferences">
    <p>
      <h3>Cancel my account</h3>
      <p>Unhappy? <%= link_to "Cancel my account", registration_path(resource_name), :data => { :confirm => "Are you sure?" }, :method => :delete %>.</p>
    </p>
  </div>
</div>