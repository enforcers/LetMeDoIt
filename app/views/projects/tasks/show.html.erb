<<<<<<< HEAD
<%= render "projects/bids/new" %>

<h3><%= link_to @task.project.name, project_path(@task.project) %> / <%= @task.name %></h3>
<div class="row-fluid">
	<div class="span8">
		<h4>Maximum Budget</h4>
		<p><%= number_to_currency @task.budget, :unit => "€" %></p>
		<h4>Task Description</h4>
		<div class="description"><%= raw @task.description %></div>
        <% if @task.project.is_owner(current_user) %>
            <h4>Bids</h4>
            <%= form_for([@task.project, @task], :html => { :class => "ym-form linearize-form ym-columnar"}) do |f| %>
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>From</th>
                            <th>Amount</th>
                            <th>Comment</th>
                            <th>Accept</th>
                        </tr>
                    </thead>
                    <tbody>
                    <% @task.bids.each do |bid| %>
                        <tr>
                            <td><%= link_to bid.user.contactName, user_show_path(bid.user) %></td>
                            <td><%= number_to_currency bid.amount, :unit => "€" %></td>
                            <td><%= bid.comment %></td>
                            <td><%= f.radio_button :accepted, bid.id %></td>
                        </tr>
                    <% end %>
                    </tbody>
                </table>
                <div class="ym-fbox-button">
                    <%= f.submit "Accept selected bid", :class => "btn btn-primary" %>
                </div>
            <% end %>
        <% end %>
	</div>
	<div class="span4">
		<div class="icons deadline">
			<h3><%= distance_of_time_in_words_to_now @task.due_date %></h3>
			<span>left (<%= @task.due_date %>)</span>
		</div>
		<div class="icons offers">
			<h3><%= @task.bids.count %></h3>
			<span>Bid(s) on this Task</span>
		</div>

		<% if @task.is_open? && !@task.project.is_owner(current_user) %>
            <%= link_to 'Place bid', '#', :class => "btn btn-primary", :'data-toggle' => "modal", :'data-target' => "#place-bid" %>
        <% end %>
		<% if can? :update, @task %>
			<%= link_to 'Edit Task', edit_project_task_path(@task.project, @task), :class => "btn" %>
		<% end %>
	</div>
=======
<% content_for :javascript do %>
  <script type="text/javascript">
    $(document).ready(function(){
    	var amount = $('#bid_amount'),
    		comment = $('#bid_comment'),
    		allFields = $([]).add(amount).add(comment);

    	$('#new-bid-form').dialog({
    		autoOpen: false,
    		height: 500,
    		width: 500,
    		modal: true,
    		resizable: false,
    		buttons: {
    			'Place this bid': function() {
    				amount.removeClass('ui-state-error');
    				var fValid =
    					$.isNumeric(amount.val()) &&
    					amount.val() > 0 &&
    					amount.val() <= <%= @task.budget %>;

    				if (fValid) {
    					$('#new_bid').submit();
    				} else {
    					amount.addClass('ui-state-error')
    				}
    			},
    			Cancel: function() {
    				$(this).dialog('close');
    			}
    		},
    		close: function() {
    			allFields.val('').removeClass('ui-state-error');
    		}
    	});

    	$('#place-bid').click(function() {
    		$('#new-bid-form').dialog('open');
    	});
    });
  </script>
<% end %>
<%= render "projects/bids/new" %>

<h3><%= link_to @task.project.name, project_path(@task.project) %> / <%= @task.name %></h3>
<div class="ym-grid">
	<div class="ym-g66 ym-gl">
		<div class="ym-gbox">
			<h4>Maximum Budget</h4>
			<p><%= number_to_currency @task.budget, :unit => "€" %></p>
			<h4>Task Description</h4>
			<div class="description"><%= raw @task.description %></div>
            <% if @task.project.is_owner(current_user) %>
                <h4>Bids</h4>
                <%= form_for([@task.project, @task], :html => { :class => "ym-form linearize-form ym-columnar"}) do |f| %>
                    <table>
                        <tr>
                            <th>From</th>
                            <th>Amount</th>
                            <th>Comment</th>
                            <th>Accept</th>
                        </tr>
                        <% @task.bids.each do |bid| %>
                            <tr>
                                <td><%= link_to bid.user.contactName, user_show_path(bid.user) %></td>
                                <td><%= number_to_currency bid.amount, :unit => "€" %></td>
                                <td><%= bid.comment %></td>
                                <td><%= f.radio_button :bid_id, bid.id %></td>
                            </tr>
                        <% end %>
                    </table>
                    <div class="ym-fbox-button">
                        <%= f.submit "Accept selected bid" %>
                    </div>
                <% end %>
            <% end %>
		</div>
	</div>
	<div class="ym-g33 ym-gr">
		<div class="ym-gbox">
			<div class="icon-box deadline">
				<h3><%= distance_of_time_in_words_to_now @task.due_date %></h3>
				<span>left (<%= @task.due_date %>)</span>
			</div>
			<div class="icon-box offers">
				<h3><%= @task.bids.count %></h3>
				<span>Bid(s) on this Task</span>
			</div>

			<% if @task.is_open? && !@task.project.is_owner(current_user) %>
                <%= link_to 'Place bid', '#', :class => "ym-button", :id => "place-bid" %>
            <% end %>
			<% if can? :update, @task %>
				<%= link_to 'Edit Task', edit_project_task_path(@task.project, @task), :class => "ym-button" %>
			<% end %>
		</div>
	</div>
>>>>>>> origin/mail
</div>